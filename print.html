<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Edifice Book</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><li class="part-title">User Guide</li><li class="chapter-item expanded "><a href="user_guide/installation.html"><strong aria-hidden="true">1.</strong> Installation</a></li><li class="chapter-item expanded "><a href="user_guide/environement.html"><strong aria-hidden="true">2.</strong> Environement</a></li><li class="chapter-item expanded "><a href="user_guide/registry.html"><strong aria-hidden="true">3.</strong> Add a registry</a></li><li class="chapter-item expanded "><a href="user_guide/files.html"><strong aria-hidden="true">4.</strong> Workspace files</a></li><li class="chapter-item expanded "><a href="user_guide/module.html"><strong aria-hidden="true">5.</strong> Create your module</a></li><li class="chapter-item expanded "><a href="user_guide/dataset.html"><strong aria-hidden="true">6.</strong> Create your dataset</a></li><li class="chapter-item expanded "><a href="user_guide/target.html"><strong aria-hidden="true">7.</strong> Create your target</a></li><li class="chapter-item expanded "><a href="user_guide/build.html"><strong aria-hidden="true">8.</strong> Build your project</a></li><li class="chapter-item expanded affix "><li class="part-title">Reference guide</li><li class="chapter-item expanded "><a href="reference_guide/module.html"><strong aria-hidden="true">9.</strong> Module</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference_guide/module/file.html"><strong aria-hidden="true">9.1.</strong> File</a></li><li class="chapter-item expanded "><a href="reference_guide/module/api.html"><strong aria-hidden="true">9.2.</strong> API</a></li></ol></li><li class="chapter-item expanded "><a href="reference_guide/dag.html"><strong aria-hidden="true">10.</strong> Directed Acyclic Graph</a></li><li class="chapter-item expanded "><a href="reference_guide/dfs.html"><strong aria-hidden="true">11.</strong> Deep First Search</a></li><li class="chapter-item expanded "><a href="reference_guide/dataset.html"><strong aria-hidden="true">12.</strong> Dataset</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference_guide/dataset/file.html"><strong aria-hidden="true">12.1.</strong> File</a></li><li class="chapter-item expanded "><a href="reference_guide/dataset/rules.html"><strong aria-hidden="true">12.2.</strong> Rules</a></li><li class="chapter-item expanded "><a href="reference_guide/dataset/api.html"><strong aria-hidden="true">12.3.</strong> API</a></li></ol></li><li class="chapter-item expanded "><a href="reference_guide/target.html"><strong aria-hidden="true">13.</strong> Target</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference_guide/target/file.html"><strong aria-hidden="true">13.1.</strong> File</a></li><li class="chapter-item expanded "><a href="reference_guide/target/rules.html"><strong aria-hidden="true">13.2.</strong> Rules</a></li><li class="chapter-item expanded "><a href="reference_guide/target/api.html"><strong aria-hidden="true">13.3.</strong> API</a></li></ol></li><li class="chapter-item expanded "><a href="reference_guide/commands.html"><strong aria-hidden="true">14.</strong> Commands</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="reference_guide/commands/add.html"><strong aria-hidden="true">14.1.</strong> Add</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/build.html"><strong aria-hidden="true">14.2.</strong> Build</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/check.html"><strong aria-hidden="true">14.3.</strong> Check</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/clean.html"><strong aria-hidden="true">14.4.</strong> Clean</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/export.html"><strong aria-hidden="true">14.5.</strong> Export</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/fetch.html"><strong aria-hidden="true">14.6.</strong> Fetch</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/help.html"><strong aria-hidden="true">14.7.</strong> Help</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/info.html"><strong aria-hidden="true">14.8.</strong> Info</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/install.html"><strong aria-hidden="true">14.9.</strong> Install</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/list.html"><strong aria-hidden="true">14.10.</strong> List</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/new.html"><strong aria-hidden="true">14.11.</strong> New</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/prune.html"><strong aria-hidden="true">14.12.</strong> Prune</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/publish.html"><strong aria-hidden="true">14.13.</strong> Publish</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/run.html"><strong aria-hidden="true">14.14.</strong> Run</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/search.html"><strong aria-hidden="true">14.15.</strong> Search</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/update.html"><strong aria-hidden="true">14.16.</strong> Update</a></li><li class="chapter-item expanded "><a href="reference_guide/commands/version.html"><strong aria-hidden="true">14.17.</strong> Version</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Edifice Book</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="introduction"><a class="header" href="#introduction">Introduction</a></h1>
<p>Edifice is a package manager and build automation tool adapted to the hardware industry. Edifice has ambition to be an language-agnostique and rust-powered package manager and automation tool. Its goal is to bring a scalable solution (1000+ IP management) to the hardware industry. Edifice is born to answer to scalability limations of the open source projects Fusesoc and Edalize.</p>
<h2 id="contributing"><a class="header" href="#contributing">Contributing</a></h2>
<h2 id="license"><a class="header" href="#license">License</a></h2>
<h3 id="limitations-of-fusesoc"><a class="header" href="#limitations-of-fusesoc">Limitations of Fusesoc</a></h3>
<p>Python project Fusesoc is not able to efficiently load thousants modules from a registry:</p>
<ul>
<li>Python is very slow</li>
<li>Fusesoc resolve the dependency three for each command</li>
<li>The fileset is not flexible enough</li>
<li>Compilation options are common to the whole dependency three</li>
<li>Module API and backend tools are not versionned as module</li>
<li>Flags has an impact on module dependencies</li>
<li>Build are not lockable which prevent reproducibility</li>
</ul>
<h3 id="limitations-of-edalize"><a class="header" href="#limitations-of-edalize">Limitations of Edalize</a></h3>
<ul>
<li>Python is very slow</li>
<li>Backend API is common to all tools</li>
<li>Filesets three is flatenized before being send to backend tool</li>
</ul>
<h2 id="configuration-files"><a class="header" href="#configuration-files">Configuration files</a></h2>
<h3 id="module"><a class="header" href="#module">Module</a></h3>
<p>A module is defined by a file module.toml in a versionned directory.</p>
<pre><code class="language-toml"># module.toml

module_api = "0.1.0"

[module]
name = "module_a"
version = "0.1.0"

[dependencies]
rule_eda = "^1.2.3"
module_b = "&gt;0.2.4"
module_c = "^0.6.1"
module_d = "~1.7.3"
module_e = "2.3.*"
</code></pre>
<p>The module version has to respect the <a href="https://docs.rs/semver/latest/semver/struct.Version.html">semver version</a> syntaxe and the version constraints have to respect the <a href="https://docs.rs/semver/latest/semver/struct.VersionReq.html">semver containts</a> syntaxe.</p>
<h3 id="dataset"><a class="header" href="#dataset">Dataset</a></h3>
<p>The transitive data management is done through the file dataset.toml of each module in the tree.</p>
<pre><code class="language-toml"># dataset.toml of module_b

[eda.dataset.dataset_a]
sources = [
  "file_e",
  "file_f",
]
include_directories = []
compilation_options = [
  "+opt_c",
]
prepend = []

</code></pre>
<pre><code class="language-toml"># dataset.toml of module_a

[eda.dataset.dataset_a]
sources = [
  "file_a",
  "file_b",
]
include_directories = [
  "include/",
]
compilation_options = [
  "+opt_a",
]
prepend = [
  "module_c.dataset_a",
]

[eda.dataset.dataset_b]
sources = [
  "file_c",
  "file_d",
]
include_directories = [
  "include/",
]
compilation_options = [
  "+opt_a",
]
prepend = [
  "module_b.dataset_a",
  "dataset_a",
]

</code></pre>
<h3 id="target"><a class="header" href="#target">Target</a></h3>
<ul>
<li><input disabled="" type="checkbox"/>
TODO</li>
</ul>
<h2 id="dependencies-management"><a class="header" href="#dependencies-management">Dependencies management</a></h2>
<h3 id="fetch-registry"><a class="header" href="#fetch-registry">Fetch registry</a></h3>
<h3 id="add-dependencies-to-module"><a class="header" href="#add-dependencies-to-module">Add dependencies to module</a></h3>
<h3 id="check-module-satisfability"><a class="header" href="#check-module-satisfability">Check module satisfability</a></h3>
<h3 id="update-dependencies-version-into-lock-file"><a class="header" href="#update-dependencies-version-into-lock-file">Update dependencies version into lock file</a></h3>
<h3 id="install-modules-localy"><a class="header" href="#install-modules-localy">Install modules localy</a></h3>
<h2 id="build-generation"><a class="header" href="#build-generation">Build generation</a></h2>
<h3 id="langage-agnostique"><a class="header" href="#langage-agnostique">Langage agnostique</a></h3>
<h3 id="remotly-cachable-artifact"><a class="header" href="#remotly-cachable-artifact">Remotly cachable artifact</a></h3>
<p>Edifice containes many tools and features:</p>
<ul>
<li>A package manager (like Fusesoc, npm, composert ... etc)</li>
<li>A build automation tool (like Edalize, CMake ... etc)</li>
<li>Three configurations concept and files:
<ul>
<li>The module (module.toml): The name, the version and the dependencies of the package</li>
<li>The dataset (dataset.toml): The management of the transitives data along the dependencies tree</li>
<li>The targets (target.toml): The rules to produce the build</li>
</ul>
</li>
</ul>
<h2 id="inspirations"><a class="header" href="#inspirations">Inspirations</a></h2>
<p>The main inspirations of Edifice are:</p>
<ul>
<li>Bazel (<a href="https://bazel.build/">website</a>, <a href="https://github.com/bazelbuild/bazel/">github</a>)
<ul>
<li>Versionned rules</li>
<li>Flexibility of the flow</li>
</ul>
</li>
<li>Npm (<a href="https://www.npmjs.com/">website</a>, <a href="https://github.com/npm/cli">github</a>)
<ul>
<li>Commands</li>
<li>Usage</li>
<li>Semver</li>
</ul>
</li>
<li>Orbit (<a href="https://chaseruskin.github.io/orbit/">website</a>, <a href="https://github.com/chaseruskin/orbit">github</a>)
<ul>
<li>Usage of Rust language</li>
<li>Commands</li>
</ul>
</li>
<li>Cargo (<a href="https://doc.rust-lang.org/cargo/">website</a>, <a href="https://github.com/rust-lang/cargo">github</a>)
<ul>
<li>Commands</li>
<li>DFS algorithm</li>
</ul>
</li>
<li>Fusesoc (<a href="https://fusesoc.readthedocs.io/en/stable/user/overview.html">website</a>, <a href="https://github.com/olofk/fusesoc">github</a>)
<ul>
<li>Semver</li>
<li>DAG (Directed Acyclic Graph)</li>
<li>Generators</li>
</ul>
</li>
<li>Edalize (<a href="https://edalize.readthedocs.io/en/latest/">website</a>, <a href="https://github.com/olofk/edalize">github</a>)
<ul>
<li>Tools</li>
<li>Modular backend</li>
</ul>
</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="installation"><a class="header" href="#installation">Installation</a></h1>
<h2 id="requirements"><a class="header" href="#requirements">Requirements</a></h2>
<ul>
<li>Cargo, you can install it using this <a href="https://doc.rust-lang.org/cargo/getting-started/installation.html">instructions</a>.</li>
</ul>
<h2 id="use-cargo"><a class="header" href="#use-cargo">Use Cargo</a></h2>
<p>Run the following command to install:</p>
<pre><code class="language-shell">cargo install --git https://github.com/Annrtl/Edifice
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="environement"><a class="header" href="#environement">Environement</a></h1>
<h2 id="variables"><a class="header" href="#variables">Variables</a></h2>
<ul>
<li><code>EDIFICE_BUILD</code>: The path where the build directories are created. By default, the build is created in the current modude directory next to <code>module.toml</code>.</li>
<li><code>EDIFICE_CACHE</code>: The path where the remote registries and the remote module sources are downloaded. By default, the cache is located in <code>~/.cache/edifice</code>.</li>
<li><code>EDIFICE_REGISTRY</code>: The URI of the registries separated with a colon (<code>:</code>).</li>
</ul>
<h2 id="workspace-configuration"><a class="header" href="#workspace-configuration">Workspace configuration</a></h2>
<pre><code class="language-toml"># edifice.toml
[config]
EDIFICE_BUILD = '/local/build'
EDIFICE_CACHE = '~/.cache/edifice'
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<h2 id="user-configuration"><a class="header" href="#user-configuration">User configuration</a></h2>
<pre><code class="language-toml"># ~/.config/edifice/edifice.toml
EDIFICE_BUILD = '/local/build'
EDIFICE_CACHE = '~/.cache/edifice'
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<h2 id="global-configuration"><a class="header" href="#global-configuration">Global configuration</a></h2>
<pre><code class="language-toml"># /etc/edifice/edifice.toml
EDIFICE_BUILD = '/local/build'
EDIFICE_CACHE = '~/.cache/edifice'
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add-a-registry"><a class="header" href="#add-a-registry">Add a Registry</a></h1>
<h2 id="description"><a class="header" href="#description">Description</a></h2>
<p>The registry is used to index all released versions of the modules. It may be a local directory or a remote git repository. A remote registry may be updated in the cache using the command <code>edifice</code> <code>fetch</code>.</p>
<h2 id="use-a-registry"><a class="header" href="#use-a-registry">Use a registry</a></h2>
<h3 id="update-your-environement-variables"><a class="header" href="#update-your-environement-variables">Update your environement variables</a></h3>
<pre><code class="language-bash">export EDIFICE_REGISTRY="/project/registry:${EDIFICE_REGISTRY}"
export EDIFICE_REGISTRY="git@github.com:Annrtl/Edifice_registry.git:${EDIFICE_REGISTRY}"
</code></pre>
<h3 id="add-a-edificetoml-configuration-locally"><a class="header" href="#add-a-edificetoml-configuration-locally">Add a edifice.toml configuration locally</a></h3>
<pre><code class="language-toml"># edifice.toml
[config]
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<h3 id="add-a-edificetoml-user-configuration"><a class="header" href="#add-a-edificetoml-user-configuration">Add a edifice.toml user configuration</a></h3>
<pre><code class="language-toml"># ~/.config/edifice/edifice.toml
[config]
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<h3 id="add-a-edificetoml-global-configuration"><a class="header" href="#add-a-edificetoml-global-configuration">Add a edifice.toml global configuration</a></h3>
<pre><code class="language-toml"># /etc/edifice/edifice.toml
[config]
EDIFICE_REGISTRY = 'git@github.com:Annrtl/Edifice_registry.git:/project/registry'
</code></pre>
<h2 id="create-your-own-registry"><a class="header" href="#create-your-own-registry">Create your own registry</a></h2>
<h3 id="remote-repository"><a class="header" href="#remote-repository">Remote repository</a></h3>
<ol>
<li>Create a new repository</li>
<li>For each module to index add a <code>module.toml</code> anywhere in the repository.</li>
</ol>
<p>It is recommanded to put a file <code>module.toml</code> in a a folder <code>name/version/module.toml</code></p>
<h3 id="local-directory"><a class="header" href="#local-directory">Local directory</a></h3>
<ol>
<li>Create a new directory</li>
<li>For each module to index add a <code>module.toml</code> anywhere in the repository.</li>
</ol>
<p>It is recommanded to put a file <code>module.toml</code> in a a folder <code>name/version/module.toml</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="workspace-files"><a class="header" href="#workspace-files">Workspace files</a></h1>
<h2 id="principle"><a class="header" href="#principle">Principle</a></h2>
<p>The modules definition is split in tree files: <code>module.toml</code>, <code>dataset.toml</code> and <code>target.toml</code>. This methode optimize the execution time of Edifice commands.</p>
<h3 id="moduletoml"><a class="header" href="#moduletoml">module.toml</a></h3>
<p>The registries index only <code>module.toml</code>. This file required only to have a name, version, description and dependencies constraints. When the registry is fetched and analysed, Edifice has to read little files. The <code>dataset.toml</code> has to be known only at build time and <code>target.toml</code> only when the specified module is built.</p>
<h3 id="datasettoml"><a class="header" href="#datasettoml">dataset.toml</a></h3>
<p>This file is accessible in the cache after the resolution of the dependencies tree. Edifice has to read this file only to get transitive data, to create the build.</p>
<h3 id="targettoml"><a class="header" href="#targettoml">target.toml</a></h3>
<p>This file is only used when developer work on the specified module (E.g. running test). Edifice doesn't need to read the content of each dependencies's <code>target.toml</code>.</p>
<h2 id="commands-depending-on-the-files"><a class="header" href="#commands-depending-on-the-files">Commands depending on the files</a></h2>
<div class="table-wrapper"><table><thead><tr><th>Command</th><th>module.toml</th><th>dataset.toml</th><th>target.toml</th></tr></thead><tbody>
<tr><td>add</td><td>x</td><td></td><td></td></tr>
<tr><td>build</td><td></td><td>x</td><td>x</td></tr>
<tr><td>check</td><td>x</td><td></td><td></td></tr>
<tr><td>clean</td><td></td><td></td><td></td></tr>
<tr><td>export</td><td>x</td><td></td><td></td></tr>
<tr><td>fetch</td><td></td><td></td><td></td></tr>
<tr><td>help</td><td></td><td></td><td></td></tr>
<tr><td>info</td><td>x</td><td></td><td></td></tr>
<tr><td>install</td><td></td><td></td><td></td></tr>
<tr><td>list</td><td>x</td><td></td><td></td></tr>
<tr><td>new</td><td></td><td></td><td></td></tr>
<tr><td>prune</td><td></td><td></td><td></td></tr>
<tr><td>publish</td><td>x</td><td></td><td></td></tr>
<tr><td>run</td><td>x</td><td></td><td>x</td></tr>
<tr><td>search</td><td>x</td><td></td><td></td></tr>
<tr><td>update</td><td>x</td><td></td><td></td></tr>
<tr><td>version</td><td></td><td></td><td></td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="create-your-module"><a class="header" href="#create-your-module">Create your Module</a></h1>
<p>The file module.toml defines the name, the version and the dependencies of your module.. The sections name and versions are already defines.</p>
<h2 id="find-a-depedency"><a class="header" href="#find-a-depedency">Find a depedency</a></h2>
<p>To find the dependency you need you can use the command <code>edifice</code> <code>search</code> as follow:</p>
<pre><code class="language-shell">edifice search &lt;name&gt;
</code></pre>
<p>or</p>
<pre><code class="language-shell">edifice search &lt;description&gt;
</code></pre>
<p>The full list of the registry modules is available with the command <code>edifice</code> <code>list</code></p>
<pre><code class="language-shell">edifice list
</code></pre>
<p>To list locker module only add the option <code>--locked</code></p>
<pre><code class="language-shell">edifice list --locked
</code></pre>
<h2 id="add-depedency"><a class="header" href="#add-depedency">Add depedency</a></h2>
<p>To add a dependency from the registry you need to use the command <code>edifice</code> <code>add</code> as follow:</p>
<pre><code class="language-shell">edifice add &lt;dependency_name&gt;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-your-dataset"><a class="header" href="#create-your-dataset">Create your dataset</a></h1>
<p>The dataset handle the current module files and its children's dataset. The dataset are not used in the tree resolution. We need it at build time to provide the data to the top level module. At each level user sould have as much control as possible on every lower level dataset.</p>
<h2 id="dataset-containing-files"><a class="header" href="#dataset-containing-files">Dataset containing files</a></h2>
<pre><code class="language-toml"># dataset.toml

[eda.dataset.dataset_a]
sources = [
  "file_e",
  "file_f",
]
include_directories = []
compilation_options = [
  "+opt_c",
]
prepend = []

</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="create-your-target"><a class="header" href="#create-your-target">Create your target</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="build-your-project"><a class="header" href="#build-your-project">Build your project</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="module-1"><a class="header" href="#module-1">Module</a></h1>
<ul>
<li><a href="reference_guide/./module/file.html">File</a></li>
<li><a href="reference_guide/./module/api.html">API</a></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file"><a class="header" href="#file">File</a></h1>
<h2 id="purpose"><a class="header" href="#purpose">Purpose</a></h2>
<p>The file module.toml is used to identify the root directory of a module and define its name and version.</p>
<h2 id="example"><a class="header" href="#example">Example</a></h2>
<pre><code class="language-toml">[module]
name = "demo"
version = "0.1.0"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api"><a class="header" href="#api">API</a></h1>
<h2 id="name"><a class="header" href="#name">Name</a></h2>
<p>A String that describe the module</p>
<h2 id="version"><a class="header" href="#version">Version</a></h2>
<p>A 3-digits version that complies the standard <a href="https://semver.org/">Semantic Versioning 2.0.0</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="directed-acyclic-graph"><a class="header" href="#directed-acyclic-graph">Directed Acyclic Graph</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="deep-first-search"><a class="header" href="#deep-first-search">Deep First Search</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="dataset-1"><a class="header" href="#dataset-1">Dataset</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-1"><a class="header" href="#file-1">File</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rules"><a class="header" href="#rules">Rules</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-1"><a class="header" href="#api-1">API</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="target-1"><a class="header" href="#target-1">Target</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="file-2"><a class="header" href="#file-2">File</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="rules-1"><a class="header" href="#rules-1">Rules</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="api-2"><a class="header" href="#api-2">API</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="commands"><a class="header" href="#commands">Commands</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="add"><a class="header" href="#add">Add</a></h1>
<h2 id="description-1"><a class="header" href="#description-1">Description</a></h2>
<p>Add a dependency to the current directory module.</p>
<h2 id="synopsys"><a class="header" href="#synopsys">Synopsys</a></h2>
<p><code>edifice</code> <code>add</code> [<em>option</em>] <em>name</em></p>
<ul>
<li>Where <em>name</em> is a String.</li>
</ul>
<p><code>edifice</code> <code>add</code> [<em>option</em>] <em>name</em>@<em>version_requirement</em></p>
<ul>
<li>Where <em>name</em> is a String.</li>
<li>Where <em>version_requirement</em> is a String with respecting the format of <a href="https://docs.rs/semver/latest/semver/struct.VersionReq.html">VersionReq</a>.</li>
</ul>
<h2 id="options"><a class="header" href="#options">Options</a></h2>
<p><code>--dry-run</code>: Look for an available version of the module but do not modify module.toml.</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples"><a class="header" href="#examples">Examples</a></h2>
<p><code>edifice</code> <code>add</code> dff</p>
<p><code>edifice</code> <code>add</code> dff@0.1.4</p>
<p><code>edifice</code> <code>add</code> dff@^0.1.0</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="build"><a class="header" href="#build">Build</a></h1>
<h2 id="description-2"><a class="header" href="#description-2">Description</a></h2>
<p>Generate the build directory with a Makefile to run target. This generation depends on the backend rules used by the module.</p>
<h2 id="synopsys-1"><a class="header" href="#synopsys-1">Synopsys</a></h2>
<p><code>edifice</code> <code>build</code> [<em>option</em>]</p>
<h2 id="options-1"><a class="header" href="#options-1">Options</a></h2>
<p><code>--build-dir</code>: Location of the generate build directory. By default the location is the current directory. This option overwrite the environment variable <code>EDIFICE_BUILD_DIR</code>.</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-1"><a class="header" href="#examples-1">Examples</a></h2>
<p><code>edifice</code> <code>build</code></p>
<p><code>edifice</code> <code>build</code> --build-dir /local/edifice</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="check"><a class="header" href="#check">Check</a></h1>
<h2 id="description-3"><a class="header" href="#description-3">Description</a></h2>
<p>Check the requirements of the module is satisfiable.</p>
<h2 id="synopsys-2"><a class="header" href="#synopsys-2">Synopsys</a></h2>
<p><code>edifice</code> <code>check</code> [<em>option</em>]</p>
<h2 id="options-2"><a class="header" href="#options-2">Options</a></h2>
<p><code>--unique</code>: Requiere en unique version of each module in the dependency tree.</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-2"><a class="header" href="#examples-2">Examples</a></h2>
<p><code>edifice</code> <code>build</code></p>
<p><code>edifice</code> <code>build</code> --unique</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="clean"><a class="header" href="#clean">Clean</a></h1>
<h2 id="description-4"><a class="header" href="#description-4">Description</a></h2>
<p>Remove the module build directory</p>
<h2 id="synopsys-3"><a class="header" href="#synopsys-3">Synopsys</a></h2>
<p><code>edifice</code> <code>clean</code> [<em>option</em>]</p>
<h2 id="options-3"><a class="header" href="#options-3">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-3"><a class="header" href="#examples-3">Examples</a></h2>
<p><code>edifice</code> <code>clean</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="export"><a class="header" href="#export">Export</a></h1>
<h2 id="description-5"><a class="header" href="#description-5">Description</a></h2>
<p>Create a compressed directory allowing anyone to run the targets without edifice tool. This file is generated in the module directory next to module.toml. If no build directory exists yet, <code>edifice</code> <code>build</code> is implicitly ran and then compressed.</p>
<p>The compressed directory contains:</p>
<ul>
<li>Makefile / Script</li>
<li>Sources</li>
<li>Artifacts (If some targets was already ran in build directory before the export)</li>
</ul>
<h2 id="synopsys-4"><a class="header" href="#synopsys-4">Synopsys</a></h2>
<p><code>edifice</code> <code>export</code> [<em>option</em>]</p>
<h2 id="options-4"><a class="header" href="#options-4">Options</a></h2>
<p><code>--format</code>: Compression format. Default format is <code>gz</code></p>
<ul>
<li><code>gz</code>: <em>module</em>_<em>version</em>.tar.gz</li>
<li><code>zip</code>: <em>module</em>_<em>version</em>.zip</li>
</ul>
<p><code>--name</code> <em>name</em>: Name of the compressed file: <em>name</em>.tar.gz</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-4"><a class="header" href="#examples-4">Examples</a></h2>
<p><code>edifice</code> <code>export</code></p>
<p><code>edifice</code> <code>export</code> --format zip</p>
<p><code>edifice</code> <code>export</code> --name issue_1234</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="fetch"><a class="header" href="#fetch">Fetch</a></h1>
<h2 id="description-6"><a class="header" href="#description-6">Description</a></h2>
<p>Update the cache of remote registries. This command should no be used if the registry is a local directory.</p>
<h2 id="synopsys-5"><a class="header" href="#synopsys-5">Synopsys</a></h2>
<p><code>edifice</code> <code>fetch</code> [<em>option</em>]</p>
<h2 id="options-5"><a class="header" href="#options-5">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-5"><a class="header" href="#examples-5">Examples</a></h2>
<p><code>edifice</code> <code>fetch</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="help"><a class="header" href="#help">Help</a></h1>
<h2 id="description-7"><a class="header" href="#description-7">Description</a></h2>
<p>Display the commands and global options of Edifice.</p>
<h2 id="synopsys-6"><a class="header" href="#synopsys-6">Synopsys</a></h2>
<p><code>edifice</code> <code>help</code> [<em>option</em>]</p>
<h2 id="options-6"><a class="header" href="#options-6">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-6"><a class="header" href="#examples-6">Examples</a></h2>
<p><code>edifice</code> <code>help</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="info"><a class="header" href="#info">Info</a></h1>
<h2 id="description-8"><a class="header" href="#description-8">Description</a></h2>
<p>Display informations about the module:</p>
<ul>
<li>Name</li>
<li>Version</li>
<li>Dependencies</li>
<li>Datasets</li>
<li>Targets</li>
</ul>
<p>You can specifiy a name and version to get informations of a module in registries.</p>
<h2 id="synopsys-7"><a class="header" href="#synopsys-7">Synopsys</a></h2>
<p><code>edifice</code> <code>info</code> [<em>option</em>] [<em>name</em>[@<em>version</em>]]</p>
<h2 id="options-7"><a class="header" href="#options-7">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-7"><a class="header" href="#examples-7">Examples</a></h2>
<p><code>edifice</code> <code>info</code></p>
<p><code>edifice</code> <code>info</code> dff</p>
<p><code>edifice</code> <code>info</code> dff@0.1.4</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="install"><a class="header" href="#install">Install</a></h1>
<h2 id="description-9"><a class="header" href="#description-9">Description</a></h2>
<p>Clone the dependencies directory in a new directory <code>modules</code> located in the module directory (next to module.toml).</p>
<h2 id="synopsys-8"><a class="header" href="#synopsys-8">Synopsys</a></h2>
<p><code>edifice</code> <code>install</code></p>
<h2 id="options-8"><a class="header" href="#options-8">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-8"><a class="header" href="#examples-8">Examples</a></h2>
<p><code>edifice</code> <code>install</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="list"><a class="header" href="#list">List</a></h1>
<h2 id="description-10"><a class="header" href="#description-10">Description</a></h2>
<p>Display the list of available modules and their versions. If no regex pattern is specificed in argument, list all modules.</p>
<h2 id="synopsys-9"><a class="header" href="#synopsys-9">Synopsys</a></h2>
<p><code>edifice</code> <code>list</code> [<em>option</em>] [<em>regex pattern</em>]</p>
<h2 id="options-9"><a class="header" href="#options-9">Options</a></h2>
<p><code>--locked</code>: List only modules of the lockfile</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-9"><a class="header" href="#examples-9">Examples</a></h2>
<p><code>edifice</code> <code>list</code></p>
<p><code>edifice</code> <code>list</code> '.*_model'</p>
<p><code>edifice</code> <code>list</code> --locked</p>
<p><code>edifice</code> <code>list</code> --locked '.*_model'</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="new"><a class="header" href="#new">New</a></h1>
<h2 id="description-11"><a class="header" href="#description-11">Description</a></h2>
<p>Create a new project directory containing the minimal configuration files to run a first build.</p>
<pre><code class="language-shell">my_project/
├── .gitignore
├── dataset.toml
├── module.toml
├── README.md
├── src
└── target.toml
</code></pre>
<h2 id="synopsys-10"><a class="header" href="#synopsys-10">Synopsys</a></h2>
<p><code>edifice</code> <code>new</code> [<em>option</em>] <em>name</em></p>
<h2 id="options-10"><a class="header" href="#options-10">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-10"><a class="header" href="#examples-10">Examples</a></h2>
<p><code>edifice</code> <code>new</code> my_project</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="prune"><a class="header" href="#prune">Prune</a></h1>
<h2 id="description-12"><a class="header" href="#description-12">Description</a></h2>
<p>Remove the cache of the remote registry.</p>
<h2 id="synopsys-11"><a class="header" href="#synopsys-11">Synopsys</a></h2>
<p><code>edifice</code> <code>prune</code> [<em>option</em>]</p>
<h2 id="options-11"><a class="header" href="#options-11">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-11"><a class="header" href="#examples-11">Examples</a></h2>
<p><code>edifice</code> <code>prune</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="publish"><a class="header" href="#publish">Publish</a></h1>
<h2 id="description-13"><a class="header" href="#description-13">Description</a></h2>
<p>Generate a copy of your module file with a registry section.</p>
<p>Two registry type are available:</p>
<ul>
<li>Git</li>
</ul>
<pre><code class="language-toml"># $EDIFICE_REGISTRY/module/module.toml with git registry
[registry]
uri = "git@github.com:edifice/module.git"
commit = "fad83baa880db7b3ba61b88fdafdde2a666da05f"
</code></pre>
<ul>
<li>Local</li>
</ul>
<pre><code class="language-toml"># $EDIFICE_REGISTRY/module/module.toml with local registry
[registry]
uri = "/absolute/path/to/local/module/directory"
</code></pre>
<p>If <code>.git</code> directory doesn't exists in the module directory, local registry is used.</p>
<h2 id="synopsys-12"><a class="header" href="#synopsys-12">Synopsys</a></h2>
<p><code>edifice</code> <code>publish</code> [<em>option</em>]</p>
<h2 id="options-12"><a class="header" href="#options-12">Options</a></h2>
<p><code>--type</code>: Type of registry:</p>
<ul>
<li><code>git</code>: Git uri</li>
<li><code>local</code>: Local path</li>
</ul>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-12"><a class="header" href="#examples-12">Examples</a></h2>
<p><code>edifice</code> <code>publish</code></p>
<p><code>edifice</code> <code>publish</code> --type local</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="run"><a class="header" href="#run">Run</a></h1>
<h2 id="description-14"><a class="header" href="#description-14">Description</a></h2>
<p>Run targets of the build specified in <code>target.toml</code></p>
<h2 id="synopsys-13"><a class="header" href="#synopsys-13">Synopsys</a></h2>
<p><code>edifice</code> <code>run</code> [<em>option</em>] [<em>target name regex</em>]</p>
<h2 id="options-13"><a class="header" href="#options-13">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-13"><a class="header" href="#examples-13">Examples</a></h2>
<p><code>edifice</code> <code>run</code></p>
<p><code>edifice</code> <code>run</code> '.*-lint'</p>
<p><code>edifice</code> <code>run</code> 'test_.*'</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="search"><a class="header" href="#search">Search</a></h1>
<h2 id="description-15"><a class="header" href="#description-15">Description</a></h2>
<p>Search for a module according its name and its description.</p>
<h2 id="synopsys-14"><a class="header" href="#synopsys-14">Synopsys</a></h2>
<p><code>edifice</code> <code>search</code> [<em>option</em>] <em>words</em></p>
<h2 id="options-14"><a class="header" href="#options-14">Options</a></h2>
<p><code>--locked</code>: Search only for modules of the lockfile</p>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-14"><a class="header" href="#examples-14">Examples</a></h2>
<p><code>edifice</code> <code>search</code></p>
<p><code>edifice</code> <code>search</code> 'primitive component'</p>
<p><code>edifice</code> <code>search</code> --locked</p>
<p><code>edifice</code> <code>search</code> --locked 'primitive component'</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="update"><a class="header" href="#update">Update</a></h1>
<h2 id="description-16"><a class="header" href="#description-16">Description</a></h2>
<p>Implictly run <code>edifice</code> <code>check</code> to get a satisfiable dependencies tree and write a lockfile <code>module.lock</code> which memorize the solution and guarantee the reproductibility of the build.</p>
<h2 id="synopsys-15"><a class="header" href="#synopsys-15">Synopsys</a></h2>
<p><code>edifice</code> <code>update</code> [<em>option</em>]</p>
<h2 id="options-15"><a class="header" href="#options-15">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-15"><a class="header" href="#examples-15">Examples</a></h2>
<p><code>edifice</code> <code>update</code></p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="version-1"><a class="header" href="#version-1">Version</a></h1>
<h2 id="description-17"><a class="header" href="#description-17">Description</a></h2>
<p>Display the version of Edifice</p>
<h2 id="synopsys-16"><a class="header" href="#synopsys-16">Synopsys</a></h2>
<p><code>edifice</code> <code>version</code> [<em>option</em>]</p>
<h2 id="options-16"><a class="header" href="#options-16">Options</a></h2>
<p><code>--help</code>: Display command description and options.</p>
<h2 id="examples-16"><a class="header" href="#examples-16">Examples</a></h2>
<p><code>edifice</code> <code>version</code></p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
